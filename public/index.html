<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ö –ó–µ–ª—ë–Ω–∞—è –î–æ–ª–∏–Ω–∞ v5.5.0</title>
    
    <!-- PDF Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#27ae60">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ó–µ–ª—ë–Ω–∞—è –î–æ–ª–∏–Ω–∞">
    <link rel="icon" type="image/png" sizes="32x32" href="./icon-48x48.png">
    <link rel="icon" type="image/png" sizes="192x192" href="./icon-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icon-180x180.png">
    <link rel="manifest" href="./manifest.json">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            min-height: 100vh;
            padding: 20px 20px 80px 20px;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }
        .header .version {
            font-size: 14px;
            opacity: 0.9;
        }
        .section {
            display: none;
            animation: fadeIn 0.3s;
        }
        .section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .card h2 {
            color: #27ae60;
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }
        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }
        .input-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        .btn {
            width: 100%;
            padding: 15px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn:active {
            background: #229954;
        }
        .btn-camera {
            background: #3498db;
            margin-bottom: 10px;
        }
        .btn-camera:active {
            background: #2980b9;
        }
        .btn-video {
            background: #9b59b6;
            margin-bottom: 10px;
        }
        .btn-video:active {
            background: #8e44ad;
        }
        .btn-video.recording {
            background: #e74c3c;
            animation: pulse 1s infinite;
        }
        .btn-audio {
            background: #e74c3c;
            margin-bottom: 10px;
        }
        .btn-audio:active {
            background: #c0392b;
        }
        .btn-audio.recording {
            background: #c0392b;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        #preview {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 12px;
            margin: 10px 0;
            display: none;
        }
        .photos-gallery {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        .videos-gallery,
        .video-gallery {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        .photo-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            cursor: pointer;
        }
        .photo-item .btn-delete-photo {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .photo-item .btn-delete-photo:active {
            background: rgba(192, 57, 43, 0.9);
        }
        .video-item {
            position: relative;
            aspect-ratio: 16/9;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            background: #000;
        }
        .video-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .video-item .video-preview {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .video-item .video-play-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(39, 174, 96, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .video-item .video-play-btn:active {
            background: rgba(34, 153, 84, 0.9);
        }
        .video-item .btn-delete-video {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }
        .video-item .btn-delete-video:active,
        .video-item .video-delete-btn:active {
            background: rgba(192, 57, 43, 0.9);
        }
        .video-item .video-delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }
        .video-item .video-info {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        .video-viewer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .video-viewer.active {
            display: flex;
        }
        .video-viewer #fullVideo {
            max-width: 90%;
            max-height: 90%;
            border-radius: 12px;
        }
        .photo-viewer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .photo-viewer.active {
            display: flex;
        }
        .photo-viewer #fullPhoto {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 12px;
        }
        .btn-close-photo {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            color: #333;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-close-photo:active {
            background: rgba(255,255,255,0.7);
        }
        .audio-player {
            width: 100%;
            margin: 10px 0;
            display: none;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
        }
        .audio-player audio {
            width: 100%;
        }
        .audio-info {
            margin-top: 10px;
            color: #666;
            font-size: 14px;
        }
        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            box-shadow: 0 -4px 12px rgba(0,0,0,0.1);
        }
        .nav-item {
            padding: 12px 5px;
            text-align: center;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 11px;
            color: #666;
        }
        .nav-item.active {
            color: #27ae60;
        }
        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè° –£–ö –ó–µ–ª—ë–Ω–∞—è –î–æ–ª–∏–Ω–∞</h1>
        <div class="version">v5.2.0</div>
    </div>

    <!-- –ì–ª–∞–≤–Ω–∞—è -->
    <div id="home" class="section active">
        <div class="card">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stat-grid">
                <div class="stat-item">
                    <div class="stat-value">5 234 ‚ÇΩ</div>
                    <div class="stat-label">–ö –æ–ø–ª–∞—Ç–µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">2</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">3</div>
                    <div class="stat-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                </div>
            </div>
        </div>
        <div class="card">
            <h2>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –£–ö</h2>
            <p>üì± –î–∏—Å–ø–µ—Ç—á–µ—Ä: 8 960 072 03 21</p>
            <p>‚úâÔ∏è Email: uk.gdom@yandex.ru</p>
            <p>üè¢ –ê–¥—Ä–µ—Å: —É–ª. –®–æ—Å—Å–µ–π–Ω–∞—è 4–ê, –ø–æ–º. 15</p>
        </div>
    </div>

    <!-- –ö–≤–∞—Ä—Ç–∏—Ä—ã -->
    <div id="apartments" class="section">
        <div class="card">
            <h2>üè† –ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞</h2>
            <p><strong>–ê–¥—Ä–µ—Å:</strong> —É–ª. –ó–µ–ª—ë–Ω–∞—è, –¥. 15, –∫–≤. 42</p>
            <p><strong>–ü–ª–æ—â–∞–¥—å:</strong> 65 –º¬≤</p>
            <p><strong>–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏:</strong> 2</p>
        </div>
    </div>

    <!-- –ü–ª–∞—Ç–µ–∂–∏ -->
    <div id="payments" class="section">
        <div class="card">
            <h2>üí≥ –ü–ª–∞—Ç–µ–∂–∏</h2>
            <div class="stat-item">
                <div class="stat-value">5 234 ‚ÇΩ</div>
                <div class="stat-label">–ö –æ–ø–ª–∞—Ç–µ –∑–∞ —è–Ω–≤–∞—Ä—å</div>
            </div>
            <button class="btn">–û–ø–ª–∞—Ç–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ó–∞—è–≤–∫–∏ -->
    <div id="requests" class="section">
        <div class="card">
            <h2>üìù –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</h2>
            <div class="input-group">
                <label>–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã</label>
                <input type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ç–µ—á—ë—Ç –∫—Ä–∞–Ω">
            </div>
            <div class="input-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã..."></textarea>
            </div>
            
            <!-- –ö–∞–º–µ—Ä–∞ -->
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button class="btn btn-camera" onclick="document.getElementById('photoCameraInput').click()" style="flex: 1;">
                    üì∑ –ö–∞–º–µ—Ä–∞
                </button>
                <button class="btn btn-camera" onclick="document.getElementById('photoGalleryInput').click()" style="flex: 1;">
                    üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è
                </button>
            </div>
            <!-- –ö–∞–º–µ—Ä–∞ (—Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ) -->
            <input type="file" id="photoCameraInput" accept="image/*" capture="environment" style="display:none" onchange="handlePhoto(event)">
            <!-- –í—ã–±–æ—Ä –∏–∑ –≥–∞–ª–µ—Ä–µ–∏ -->
            <input type="file" id="photoGalleryInput" accept="image/*" style="display:none" onchange="handlePhoto(event)">
            
            <!-- –í–∏–¥–µ–æ -->
            <h3 style="margin-top: 30px;">üé• –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –≤–∏–¥–µ–æ</h3>
            
            <!-- iOS: –¥–≤–µ –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥ -->
            <div id="videoButtonsIOS" style="display: none; flex-direction: row; gap: 10px; margin-bottom: 15px;">
                <button class="btn btn-primary" onclick="document.getElementById('videoCameraInput').click()" style="flex: 1;">
                    üé• –ö–∞–º–µ—Ä–∞
                </button>
                <button class="btn btn-primary" onclick="document.getElementById('videoGalleryInput').click()" style="flex: 1;">
                    üìÅ –ì–∞–ª–µ—Ä–µ—è
                </button>
            </div>
            
            <!-- Desktop/Android: –¥–≤–µ –∫–Ω–æ–ø–∫–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ -->
            <div id="videoButtonsDesktop" style="display: none; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                <button id="recordVideoBtn" class="btn btn-primary" onclick="toggleVideoRecording()" style="width: 100%;">
                    üé• –ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–µ–æ
                </button>
                <button class="btn btn-primary" onclick="document.getElementById('videoGalleryInput').click()" style="width: 100%;">
                    üìÅ –ì–∞–ª–µ—Ä–µ—è
                </button>
            </div>
            
            <!-- –°–∫—Ä—ã—Ç—ã–µ inputs -->
            <input type="file" id="videoCameraInput" accept="video/*" capture="environment" style="display:none" onchange="handleVideoFile(event)">
            <input type="file" id="videoGalleryInput" accept="video/*" multiple style="display:none" onchange="handleVideoFile(event)">
            
            <!-- –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ -->
            <div id="photosGallery" class="photos-gallery"></div>
            
            <!-- –ì–∞–ª–µ—Ä–µ—è –≤–∏–¥–µ–æ -->
            <div id="videoGallery" class="video-gallery"></div>
            
            <!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ -->
            <div id="photoViewer" class="photo-viewer" onclick="closePhotoViewer()">
                <img id="fullPhoto" alt="–§–æ—Ç–æ">
                <button class="btn-close-photo" onclick="closePhotoViewer()">‚úï</button>
            </div>
            
            <!-- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ -->
            <div id="videoViewer" class="video-viewer" onclick="closeVideoViewer()">
                <video id="fullVideo" controls></video>
                <button class="btn-close-photo" onclick="closeVideoViewer()">‚úï</button>
            </div>
            
            <button class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications" class="section">
        <div class="card">
            <h2>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            <p>üì¢ –ü–ª–∞–Ω–æ–≤–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–¥—ã 25.01 —Å 10:00 –¥–æ 16:00</p>
            <p>‚úÖ –ó–∞—è–≤–∫–∞ ‚Ññ123 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞</p>
            <p>üí∞ –ù–æ–≤–∞—è –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –∑–∞ —è–Ω–≤–∞—Ä—å</p>
        </div>
    </div>

    <!-- –ö–≤–∏—Ç–∞–Ω—Ü–∏–∏ -->
    <div id="receipts" class="section">
        <div class="card">
            <h2>üìÑ –ö–≤–∏—Ç–∞–Ω—Ü–∏–∏</h2>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; color: #333; font-weight: 500;">–ü–µ—Ä–∏–æ–¥:</label>
                <select id="receiptPeriod" style="width: 100%; padding: 12px; margin-bottom: 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                    <option value="2024-11">–ù–æ—è–±—Ä—å 2024</option>
                    <option value="2024-10">–û–∫—Ç—è–±—Ä—å 2024</option>
                    <option value="2024-09">–°–µ–Ω—Ç—è–±—Ä—å 2024</option>
                    <option value="2024-08">–ê–≤–≥—É—Å—Ç 2024</option>
                    <option value="2024-07">–ò—é–ª—å 2024</option>
                </select>
                
                <button class="btn btn-success" onclick="generateReceipt()" style="width: 100%; background: #27ae60;">
                    üì• –°–∫–∞—á–∞—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é PDF
                </button>
            </div>
            
            <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
            <div id="receiptPreview" style="background: #f8f9fa; padding: 15px; border: 1px solid #ddd; border-radius: 8px; min-height: 100px;">
                <p style="text-align: center; color: #666; margin: 20px 0;">
                    –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é"
                </p>
            </div>
        </div>
    </div>

    <!-- –°—á—ë—Ç—á–∏–∫–∏ -->
    <div id="counters" class="section">
        <div class="card">
            <h2>üî¢ –ü–µ—Ä–µ–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è</h2>
            <div class="input-group">
                <label>–•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞ (–º¬≥)</label>
                <input type="number" placeholder="–¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è">
            </div>
            <div class="input-group">
                <label>–ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞ (–º¬≥)</label>
                <input type="number" placeholder="–¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è">
            </div>
            <div class="input-group">
                <label>–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ (–∫–í—Ç‚ãÖ—á)</label>
                <input type="number" placeholder="–¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è">
            </div>
            <button class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è</button>
        </div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="nav">
        <button class="nav-item active" onclick="showSection('home')">
            <div class="nav-icon">üè†</div>
            <div>–ì–ª–∞–≤–Ω–∞—è</div>
        </button>
        <button class="nav-item" onclick="showSection('apartments')">
            <div class="nav-icon">üè¢</div>
            <div>–ö–≤–∞—Ä—Ç–∏—Ä—ã</div>
        </button>
        <button class="nav-item" onclick="showSection('payments')">
            <div class="nav-icon">üí≥</div>
            <div>–ü–ª–∞—Ç–µ–∂–∏</div>
        </button>
        <button class="nav-item" onclick="showSection('requests')">
            <div class="nav-icon">üìù</div>
            <div>–ó–∞—è–≤–∫–∏</div>
        </button>
        <button class="nav-item" onclick="showSection('notifications')">
            <div class="nav-icon">üîî</div>
            <div>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
        </button>
        <button class="nav-item" onclick="showSection('receipts')">
            <div class="nav-icon">üìÑ</div>
            <div>–ö–≤–∏—Ç–∞–Ω—Ü–∏–∏</div>
        </button>
        <button class="nav-item" onclick="showSection('counters')">
            <div class="nav-icon">üî¢</div>
            <div>–°—á—ë—Ç—á–∏–∫–∏</div>
        </button>
    </nav>

    <script>
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        
        // –í–∏–¥–µ–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let mediaRecorder = null;
        let videoStream = null;
        let videoChunks = [];
        let isRecordingVideo = false;
        let recordingTime = 0;
        let videoTimer = null;

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }
        
        function handlePhoto(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // –°–æ–∑–¥–∞—ë–º canvas –¥–ª—è —Å–∂–∞—Ç–∏—è
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    
                    // –°–∂–∏–º–∞–µ–º –¥–æ –º–∞–∫—Å–∏–º—É–º 1024px –ø–æ –±–æ–ª—å—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ
                    const maxSize = 1024;
                    if (width > height && width > maxSize) {
                        height = (height * maxSize) / width;
                        width = maxSize;
                    } else if (height > maxSize) {
                        width = (width * maxSize) / height;
                        height = maxSize;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ base64
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    savePhotoToStorage(compressedDataUrl);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –≥–∞–ª–µ—Ä–µ—é
                    addPhotoToGallery(compressedDataUrl);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
            
            // –û—á–∏—â–∞–µ–º input –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Ç–æ–≥–æ –∂–µ —Ñ–∞–π–ª–∞
            event.target.value = '';
        }
        
        function savePhotoToStorage(dataUrl) {
            let photos = JSON.parse(localStorage.getItem('requestPhotos') || '[]');
            photos.push(dataUrl);
            localStorage.setItem('requestPhotos', JSON.stringify(photos));
        }
        
        function loadPhotosFromStorage() {
            const photos = JSON.parse(localStorage.getItem('requestPhotos') || '[]');
            const gallery = document.getElementById('photosGallery');
            gallery.innerHTML = '';
            photos.forEach((photo, index) => {
                addPhotoToGallery(photo, index);
            });
        }
        
        function addPhotoToGallery(dataUrl, index = null) {
            const gallery = document.getElementById('photosGallery');
            if (!gallery) return;
            
            const photoItem = document.createElement('div');
            photoItem.className = 'photo-item';
            
            const img = document.createElement('img');
            img.src = dataUrl;
            img.onclick = () => showFullPhoto(dataUrl);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn-delete-photo';
            deleteBtn.textContent = '‚úï';
            deleteBtn.onclick = (e) => {
                e.stopPropagation();
                deletePhoto(index !== null ? index : gallery.children.length);
            };
            
            photoItem.appendChild(img);
            photoItem.appendChild(deleteBtn);
            gallery.appendChild(photoItem);
        }
        
        function deletePhoto(index) {
            let photos = JSON.parse(localStorage.getItem('requestPhotos') || '[]');
            photos.splice(index, 1);
            localStorage.setItem('requestPhotos', JSON.stringify(photos));
            loadPhotosFromStorage();
        }
        
        function showFullPhoto(dataUrl) {
            const viewer = document.getElementById('photoViewer');
            const fullPhoto = document.getElementById('fullPhoto');
            fullPhoto.src = dataUrl;
            viewer.classList.add('active');
        }
        
        function closePhotoViewer() {
            const viewer = document.getElementById('photoViewer');
            viewer.classList.remove('active');
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', function() {
            loadPhotosFromStorage();
        });

        // ========== –í–ò–î–ï–û –§–£–ù–ö–¶–ò–ò ==========
        
        function toggleVideoRecording() {
            const btn = document.getElementById('recordVideoBtn');
            
            if (!isRecordingVideo) {
                startVideoRecording();
                btn.textContent = '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å';
                btn.style.background = '#e74c3c'; // –∫—Ä–∞—Å–Ω—ã–π
            } else {
                stopVideoRecording();
                btn.textContent = 'üé• –ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–µ–æ';
                btn.style.background = '#27ae60'; // –∑–µ–ª—ë–Ω—ã–π
            }
        }
        
        async function startVideoRecording() {
            try {
                videoStream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'environment' },
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        autoGainControl: true
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –∫–æ–¥–µ–∫–æ–≤ —Å –∞—É–¥–∏–æ
                let options = null;
                const codecs = [
                    'video/webm;codecs=vp9,opus',
                    'video/webm;codecs=vp8,opus',
                    'video/webm;codecs=vp9',
                    'video/webm;codecs=vp8',
                    'video/webm'
                ];
                
                for (const codec of codecs) {
                    if (MediaRecorder.isTypeSupported(codec)) {
                        options = { mimeType: codec };
                        break;
                    }
                }
                
                if (!options) {
                    options = {};
                }
                
                mediaRecorder = new MediaRecorder(videoStream, options);
                videoChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    if (event.data && event.data.size > 0) {
                        videoChunks.push(event.data);
                    }
                };
                
                mediaRecorder.onstop = async () => {
                    const videoBlob = new Blob(videoChunks, { type: 'video/webm' });
                    await saveVideoToStorage(videoBlob);
                    
                    // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–º–µ—Ä—É
                    videoStream.getTracks().forEach(track => track.stop());
                    
                    // –°–±—Ä–æ—Å–∏—Ç—å —Ç–∞–π–º–µ—Ä
                    clearInterval(videoTimer);
                    recordingTime = 0;
                    isRecordingVideo = false;
                    
                    const btn = document.getElementById('recordVideoBtn');
                    btn.textContent = 'üé• –ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–µ–æ';
                    btn.style.background = '#27ae60';
                };
                
                mediaRecorder.start();
                isRecordingVideo = true;
                recordingTime = 0;
                
                // –¢–∞–π–º–µ—Ä –≤ –∫–Ω–æ–ø–∫–µ
                const btn = document.getElementById('recordVideoBtn');
                videoTimer = setInterval(() => {
                    recordingTime++;
                    btn.textContent = `‚èπÔ∏è –ó–∞–ø–∏—Å—å... ${recordingTime}—Å`;
                    
                    // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
                    if (recordingTime >= 30) {
                        toggleVideoRecording();
                    }
                }, 1000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ:', error);
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ');
                isRecordingVideo = false;
            }
        }
        
        function stopVideoRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            if (videoTimer) {
                clearInterval(videoTimer);
                videoTimer = null;
            }
            isRecordingVideo = false;
            recordingTime = 0;
        }
        
        async function handleVideoFile(event) {
            const files = event.target.files;
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä (–º–∞–∫—Å 10 –ú–ë)
                const sizeInMB = file.size / (1024 * 1024);
                if (sizeInMB > 10) {
                    alert(`‚ùå –í–∏–¥–µ–æ "${file.name}" —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ (${sizeInMB.toFixed(2)} –ú–ë). –ú–∞–∫—Å–∏–º—É–º 10 –ú–ë.`);
                    continue;
                }
                
                // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∏–¥–µ–æ
                await saveVideoToStorage(file);
            }
            
            // –û—á–∏—Å—Ç–∏—Ç—å input
            event.target.value = '';
        }
        
        async function saveVideoToStorage(videoBlob) {
            try {
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å blob –≤ base64 –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage
                const reader = new FileReader();
                
                reader.onloadend = function() {
                    const base64Video = reader.result; // data:video/webm;base64,...
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä (localStorage –æ–≥—Ä–∞–Ω–∏—á–µ–Ω ~5-10 –ú–ë)
                    const sizeInMB = (base64Video.length * 0.75) / (1024 * 1024);
                    if (sizeInMB > 10) {
                        alert('‚ùå –í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ (> 10 –ú–ë). –í—ã–±–µ—Ä–∏—Ç–µ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ.');
                        return;
                    }
                    
                    // –ü–æ–ª—É—á–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∏–¥–µ–æ
                    let videos = JSON.parse(localStorage.getItem('videos') || '[]');
                    
                    // –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ
                    const videoData = {
                        id: Date.now(),
                        data: base64Video,
                        timestamp: new Date().toISOString(),
                        size: sizeInMB.toFixed(2) + ' –ú–ë'
                    };
                    
                    videos.push(videoData);
                    
                    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ localStorage
                    localStorage.setItem('videos', JSON.stringify(videos));
                    
                    // –î–æ–±–∞–≤–∏—Ç—å –≤ –≥–∞–ª–µ—Ä–µ—é
                    addVideoToGallery(videoData);
                    
                    console.log('‚úÖ –í–∏–¥–µ–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ localStorage');
                };
                
                reader.onerror = function() {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∏–¥–µ–æ –≤ base64');
                    alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ');
                };
                
                reader.readAsDataURL(videoBlob);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ');
            }
        }
        
        function loadVideosFromStorage() {
            try {
                const videos = JSON.parse(localStorage.getItem('videos') || '[]');
                
                videos.forEach(videoData => {
                    addVideoToGallery(videoData);
                });
                
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${videos.length} –≤–∏–¥–µ–æ –∏–∑ localStorage`);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:', error);
            }
        }
        
        function addVideoToGallery(videoData) {
            const gallery = document.getElementById('videoGallery');
            if (!gallery) return;
            
            const videoItem = document.createElement('div');
            videoItem.className = 'video-item';
            videoItem.dataset.videoId = videoData.id;
            
            // –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–≤—å—é —Å base64 –¥–∞–Ω–Ω—ã–º–∏
            const preview = document.createElement('div');
            preview.className = 'video-preview';
            preview.onclick = () => showFullVideo(videoData.id);
            
            const video = document.createElement('video');
            video.src = videoData.data;
            video.preload = 'metadata';
            video.muted = true;
            video.style.width = '100%';
            video.style.height = '100%';
            video.style.objectFit = 'cover';
            
            const playBtn = document.createElement('div');
            playBtn.className = 'video-play-btn';
            playBtn.textContent = '‚ñ∂';
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'video-delete-btn';
            deleteBtn.textContent = '‚úï';
            deleteBtn.onclick = (e) => {
                e.stopPropagation();
                deleteVideo(videoData.id);
            };
            
            const info = document.createElement('div');
            info.className = 'video-info';
            info.textContent = videoData.size || 'N/A';
            
            preview.appendChild(video);
            preview.appendChild(playBtn);
            videoItem.appendChild(preview);
            videoItem.appendChild(deleteBtn);
            videoItem.appendChild(info);
            gallery.appendChild(videoItem);
        }
        
        function deleteVideo(videoId) {
            let videos = JSON.parse(localStorage.getItem('videos') || '[]');
            videos = videos.filter(v => v.id !== videoId);
            localStorage.setItem('videos', JSON.stringify(videos));
            
            // –£–¥–∞–ª–∏—Ç—å –∏–∑ DOM
            const videoItem = document.querySelector(`[data-video-id="${videoId}"]`);
            if (videoItem) {
                videoItem.remove();
            }
        }
        
        function showFullVideo(videoId) {
            const videos = JSON.parse(localStorage.getItem('videos') || '[]');
            const videoData = videos.find(v => v.id === videoId);
            if (!videoData) return;
            
            const viewer = document.getElementById('videoViewer');
            const fullVideo = document.getElementById('fullVideo');
            fullVideo.src = videoData.data;
            viewer.classList.add('active');
        }
        
        function closeVideoViewer() {
            const viewer = document.getElementById('videoViewer');
            const fullVideo = document.getElementById('fullVideo');
            fullVideo.pause();
            fullVideo.src = '';
            viewer.classList.remove('active');
        }
        
        // ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–í–ò–¢–ê–ù–¶–ò–ô PDF ==========
        
        async function generateReceipt() {
            const period = document.getElementById('receiptPeriod').value;
            const [year, month] = period.split('-');
            const monthNames = ['–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å',
                                '–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'];
            const periodText = monthNames[parseInt(month)-1] + ' ' + year;
            
            // –°–æ–∑–¥–∞—Ç—å PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à—Ä–∏—Ñ—Ç
            doc.setFont('helvetica');
            
            let y = 20; // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ø–æ Y
            
            // ============ –®–ê–ü–ö–ê ============
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text('–ö–í–ò–¢–ê–ù–¶–ò–Ø', 105, y, { align: 'center' });
            y += 7;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text('–£–ö "–ó–µ–ª—ë–Ω–∞—è –î–æ–ª–∏–Ω–∞"', 105, y, { align: 'center' });
            y += 5;
            doc.text('–ò–ù–ù: 7701234567  –ö–ü–ü: 770101001  –û–ì–†–ù: 1234567890123', 105, y, { align: 'center' });
            y += 5;
            doc.text('–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1', 105, y, { align: 'center' });
            y += 10;
            
            // –õ–∏–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
            doc.line(20, y, 190, y);
            y += 7;
            
            // ============ –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –°–û–ë–°–¢–í–ï–ù–ù–ò–ö–ï ============
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–µ', 20, y);
            y += 7;
            
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('–ü–µ—Ä–∏–æ–¥: ' + periodText, 20, y);
            doc.text('–õ–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç: 1234567890', 120, y);
            y += 5;
            doc.text('–ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –∫–≤. 45', 20, y);
            y += 5;
            doc.text('–§–ò–û: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 20, y);
            y += 5;
            doc.text('–ü–ª–æ—â–∞–¥—å: 54.3 –º¬≤', 20, y);
            doc.text('–ü—Ä–æ–ø–∏—Å–∞–Ω–æ: 3 —á–µ–ª.', 120, y);
            y += 8;
            
            // –õ–∏–Ω–∏—è
            doc.line(20, y, 190, y);
            y += 7;
            
            // ============ –ù–ê–ß–ò–°–õ–ï–ù–ò–Ø ============
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏', 20, y);
            y += 5;
            
            // –¢–∞–±–ª–∏—Ü–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
            const charges = [
                ['–•–æ–ª–æ–¥–Ω–æ–µ –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', '12.5', '–º¬≥', '45.67', '0.00', '570.88'],
                ['–ì–æ—Ä—è—á–µ–µ –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', '8.2', '–º¬≥', '187.21', '0.00', '1,535.12'],
                ['–û—Ç–æ–ø–ª–µ–Ω–∏–µ', '54.3', '–º¬≤', '215.34', '0.00', '11,692.96'],
                ['–≠–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è', '145', '–∫–í—Ç*—á', '6.19', '0.00', '897.55'],
                ['–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∂–∏–ª–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è', '54.3', '–º¬≤', '35.00', '0.00', '1,900.50'],
                ['–û–î–ù —Ö–æ–ª–æ–¥–Ω–æ–µ –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', '2.1', '–º¬≥', '45.67', '0.00', '95.91'],
                ['–û–î–ù –≥–æ—Ä—è—á–µ–µ –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ', '1.3', '–º¬≥', '187.21', '0.00', '243.37'],
                ['–û–î–ù —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è', '18', '–∫–í—Ç*—á', '6.19', '0.00', '111.42']
            ];
            
            doc.autoTable({
                startY: y,
                head: [['–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏', '–û–±—ä—ë–º', '–ï–¥.', '–¢–∞—Ä–∏—Ñ', '–ü–µ—Ä–µ—Ä–∞—Å—á—ë—Ç', '–ò—Ç–æ–≥–æ']],
                body: charges,
                foot: [['', '', '', '', '–ò–¢–û–ì–û:', '17,047.71']],
                theme: 'grid',
                styles: { 
                    fontSize: 8,
                    cellPadding: 2,
                    font: 'helvetica'
                },
                headStyles: { 
                    fillColor: [39, 174, 96],
                    textColor: 255,
                    fontStyle: 'bold'
                },
                footStyles: {
                    fillColor: [240, 240, 240],
                    fontStyle: 'bold'
                },
                columnStyles: {
                    0: { cellWidth: 70 },
                    1: { cellWidth: 18, halign: 'right' },
                    2: { cellWidth: 15 },
                    3: { cellWidth: 22, halign: 'right' },
                    4: { cellWidth: 22, halign: 'right' },
                    5: { cellWidth: 25, halign: 'right' }
                }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // ============ –°–ü–†–ê–í–û–ß–ù–û ============
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('–°–ø—Ä–∞–≤–æ—á–Ω–æ', 20, y);
            y += 7;
            
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞:', 20, y);
            doc.text('2,450.00 —Ä—É–±.', 150, y, { align: 'right' });
            y += 5;
            doc.text('–ù–∞—á–∏—Å–ª–µ–Ω–æ –∑–∞ —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥:', 20, y);
            doc.text('17,047.71 —Ä—É–±.', 150, y, { align: 'right' });
            y += 5;
            doc.text('–û–ø–ª–∞—á–µ–Ω–æ:', 20, y);
            doc.text('15,000.00 —Ä—É–±.', 150, y, { align: 'right' });
            y += 5;
            doc.setFont('helvetica', 'bold');
            doc.text('–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞:', 20, y);
            doc.text('4,497.71 —Ä—É–±.', 150, y, { align: 'right' });
            y += 8;
            
            // –õ–∏–Ω–∏—è
            doc.line(20, y, 190, y);
            y += 7;
            
            // ============ –ü–õ–ê–¢–Å–ñ–ù–´–ï –†–ï–ö–í–ò–ó–ò–¢–´ ============
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('–ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã', 20, y);
            y += 7;
            
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('–ü–æ–ª—É—á–∞—Ç–µ–ª—å: –£–ö "–ó–µ–ª—ë–Ω–∞—è –î–æ–ª–∏–Ω–∞"', 20, y);
            y += 5;
            doc.text('–ò–ù–ù: 7701234567  –ö–ü–ü: 770101001', 20, y);
            y += 5;
            doc.text('–ë–∞–Ω–∫: –ü–ê–û "–°–±–µ—Ä–±–∞–Ω–∫"', 20, y);
            y += 5;
            doc.text('–†/—Å: 40702810400000012345', 20, y);
            y += 5;
            doc.text('–ö/—Å: 30101810400000000225  –ë–ò–ö: 044525225', 20, y);
            y += 10;
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ: 10.12.' + year, 20, y);
            doc.text('–°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ: 4,497.71 —Ä—É–±.', 120, y);
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PDF
            doc.save('kvitanciya_' + period + '.pdf');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
            const preview = document.getElementById('receiptPreview');
            preview.innerHTML = `
                <p style="text-align: center; color: #27ae60; font-weight: bold; margin: 10px 0;">
                    ‚úÖ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –∑–∞ ${periodText} —Å–∫–∞—á–∞–Ω–∞!
                </p>
                <p style="text-align: center; color: #666; font-size: 14px;">
                    –§–∞–π–ª: kvitanciya_${period}.pdf
                </p>
            `;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            const isIOSDevice = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            
            if (isIOSDevice) {
                // iOS: –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫–∏ "–ö–∞–º–µ—Ä–∞" –∏ "–ì–∞–ª–µ—Ä–µ—è"
                document.getElementById('videoButtonsIOS').style.display = 'flex';
                document.getElementById('videoButtonsDesktop').style.display = 'none';
            } else {
                // Desktop/Android: –ø–æ–∫–∞–∑–∞—Ç—å "–ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–µ–æ" –∏ "–ì–∞–ª–µ—Ä–µ—è"
                document.getElementById('videoButtonsIOS').style.display = 'none';
                document.getElementById('videoButtonsDesktop').style.display = 'flex';
            }
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ
            loadPhotosFromStorage();
            loadVideosFromStorage();
        });
    </script>
</body>
</html>
