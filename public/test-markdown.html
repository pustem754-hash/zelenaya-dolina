<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown to HTML - –¢–µ—Å—Ç—ã</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ccc;
        }
        .test.pass {
            border-color: #27ae60;
        }
        .test.fail {
            border-color: #e74c3c;
        }
        .test-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .expected, .actual {
            font-family: monospace;
            font-size: 12px;
            background: #f8f9fa;
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .summary {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            font-size: 18px;
        }
        .summary.success {
            border: 3px solid #27ae60;
            color: #27ae60;
        }
        .summary.failure {
            border: 3px solid #e74c3c;
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç—ã Markdown to HTML</h1>
    <div id="results"></div>
    <div id="summary" class="summary"></div>

    <script>
        // Markdown to HTML —Ñ—É–Ω–∫—Ü–∏—è
        function markdownToHTML(markdown) {
            if (!markdown) return '';
            
            let html = markdown;
            
            // 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–ª–æ–∫–∏ –∫–æ–¥–∞
            const codeBlocks = [];
            html = html.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, lang, code) => {
                const placeholder = `__CODE_BLOCK_${codeBlocks.length}__`;
                const langClass = lang ? ` class="language-${lang}"` : '';
                codeBlocks.push(`<pre><code${langClass}>${code}</code></pre>`);
                return placeholder;
            });
            
            // 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–ª–∞–π–Ω –∫–æ–¥
            const inlineCodes = [];
            html = html.replace(/`([^`]+)`/g, (match, code) => {
                const placeholder = `__INLINE_CODE_${inlineCodes.length}__`;
                inlineCodes.push(`<code>${code}</code>`);
                return placeholder;
            });
            
            // 3. –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
            html = html
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
            
            // 4. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–¥
            codeBlocks.forEach((block, i) => {
                html = html.replace(`__CODE_BLOCK_${i}__`, block);
            });
            inlineCodes.forEach((code, i) => {
                html = html.replace(`__INLINE_CODE_${i}__`, code);
            });
            
            // 5. –ó–∞–≥–æ–ª–æ–≤–∫–∏
            html = html.replace(/^######\s+(.+)$/gm, '<h6>$1</h6>');
            html = html.replace(/^#####\s+(.+)$/gm, '<h5>$1</h5>');
            html = html.replace(/^####\s+(.+)$/gm, '<h4>$1</h4>');
            html = html.replace(/^###\s+(.+)$/gm, '<h3>$1</h3>');
            html = html.replace(/^##\s+(.+)$/gm, '<h2>$1</h2>');
            html = html.replace(/^#\s+(.+)$/gm, '<h1>$1</h1>');
            
            // 6. –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            html = html.replace(/^---$/gm, '<hr>');
            html = html.replace(/^\*\*\*$/gm, '<hr>');
            html = html.replace(/^___$/gm, '<hr>');
            
            // 7. –ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
            html = html.replace(/^[-*]\s+(.+)$/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*?<\/li>\n?)+/g, match => `<ul>\n${match}</ul>`);
            
            // 8. –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏  
            html = html.replace(/^\d+\.\s+(.+)$/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*?<\/li>\n?)+/g, match => {
                if (match.includes('<ul>')) return match;
                return `<ol>\n${match}</ol>`;
            });
            
            // 9. –¶–∏—Ç–∞—Ç—ã
            html = html.replace(/^&gt;\s+(.+)$/gm, '<blockquote>$1</blockquote>');
            
            // 10. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');
            
            // 11. –°—Å—ã–ª–∫–∏
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>');
            
            // 12. –ñ–∏—Ä–Ω—ã–π
            html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/__(.+?)__/g, '<strong>$1</strong>');
            
            // 13. –ö—É—Ä—Å–∏–≤
            html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');
            html = html.replace(/_(.+?)_/g, '<em>$1</em>');
            
            // 14. –ó–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π
            html = html.replace(/~~(.+?)~~/g, '<del>$1</del>');
            
            // 15. –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
            html = html.replace(/  \n/g, '<br>\n');
            
            // 16. –ü–∞—Ä–∞–≥—Ä–∞—Ñ—ã
            const blocks = html.split(/\n\n+/);
            html = blocks.map(block => {
                const trimmed = block.trim();
                if (!trimmed) return '';
                if (trimmed.match(/^<(h[1-6]|ul|ol|pre|blockquote|hr)/)) {
                    return trimmed;
                }
                return `<p>${trimmed}</p>`;
            }).filter(b => b).join('\n');
            
            return html;
        }

        // –¢–µ—Å—Ç—ã
        const tests = [
            { name: 'H1', input: '# Heading 1', expected: '<h1>Heading 1</h1>' },
            { name: 'H2', input: '## Heading 2', expected: '<h2>Heading 2</h2>' },
            { name: 'H3', input: '### Heading 3', expected: '<h3>Heading 3</h3>' },
            { name: 'Bold **', input: '**bold**', expected: '<p><strong>bold</strong></p>' },
            { name: 'Bold __', input: '__bold__', expected: '<p><strong>bold</strong></p>' },
            { name: 'Italic *', input: '*italic*', expected: '<p><em>italic</em></p>' },
            { name: 'Italic _', input: '_italic_', expected: '<p><em>italic</em></p>' },
            { name: 'Strikethrough', input: '~~text~~', expected: '<p><del>text</del></p>' },
            { name: 'Inline code', input: '`code`', expected: '<p><code>code</code></p>' },
            { name: 'Link', input: '[Google](https://google.com)', expected: '<p><a href="https://google.com">Google</a></p>' },
            { name: 'Image', input: '![Alt](img.png)', expected: '<p><img src="img.png" alt="Alt"></p>' },
            { name: 'HR ---', input: '---', expected: '<hr>' },
            { name: 'HR ***', input: '***', expected: '<hr>' },
            { name: 'Blockquote', input: '> Quote', expected: '<blockquote>Quote</blockquote>' },
            { name: 'Empty', input: '', expected: '' },
            { name: 'Escape HTML', input: '<script>alert("XSS")</script>', expected: '<p>&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</p>' },
            { name: 'Combo bold + italic', input: 'Text **bold** and *italic*', expected: '<p>Text <strong>bold</strong> and <em>italic</em></p>' },
        ];

        let passed = 0;
        let failed = 0;
        const results = document.getElementById('results');

        tests.forEach(({ name, input, expected }) => {
            const actual = markdownToHTML(input);
            const isPass = actual === expected;
            
            if (isPass) {
                passed++;
            } else {
                failed++;
            }

            const div = document.createElement('div');
            div.className = `test ${isPass ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <div class="test-name">${isPass ? '‚úÖ' : '‚ùå'} ${name}</div>
                ${!isPass ? `
                    <div class="expected"><strong>–û–∂–∏–¥–∞–ª–æ—Å—å:</strong><br>${escapeHtml(expected)}</div>
                    <div class="actual"><strong>–ü–æ–ª—É—á–µ–Ω–æ:</strong><br>${escapeHtml(actual)}</div>
                ` : ''}
            `;
            results.appendChild(div);
        });

        function escapeHtml(text) {
            return text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }

        const summary = document.getElementById('summary');
        summary.className = `summary ${failed === 0 ? 'success' : 'failure'}`;
        summary.innerHTML = `
            <div><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</strong></div>
            <div>‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}</div>
            <div>‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: ${failed}</div>
            ${failed === 0 ? '<div style="font-size: 24px; margin-top: 10px;">üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!</div>' : ''}
        `;
    </script>
</body>
</html>













